/**
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 */

@import 'https://fonts.googleapis.com/css?family=Reenie+Beanie';

/* Hide scrollbars but allow scrolling */
::-webkit-scrollbar {
  display: none !important;
}

* {
  -ms-overflow-style: none;
  /* IE and Edge */
  scrollbar-width: none;
  /* Firefox */
}

html,
body {
  margin: 0 !important;
  padding: 0 !important;
  width: 100% !important;
  height: 100% !important;
  overflow-x: hidden !important;
  /* Prevent horizontal scrollbar */
  overflow-y: hidden !important;
  /* Layout is controlled via containers */
  font-family:
    system-ui,
    -apple-system,
    BlinkMacSystemFont,
    '.SFNSText-Regular',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background: var(--app-bg, #eee);
  color: var(--text-color, #1a1a1a);
}

mark {
  background-color: unset;
  color: inherit;
}


header {
  max-width: 580px;
  margin: auto;
  position: relative;
  display: flex;
  justify-content: center;
}

header a {
  max-width: 220px;
  margin: 20px 0 0 0;
  display: block;
}

header img {
  display: block;
  height: 100%;
  width: 100%;
}

header h1 {
  text-align: left;
  color: #333;
  display: inline-block;
  margin: 20px 0 0 0;
}

.editor-shell {
  margin: 0;
  border-radius: 0;
  max-width: none;
  color: inherit;
  position: relative;
  line-height: 1.7;
  font-weight: 400;
}

.editor-shell .editor-container {
  background: var(--module-bg, #fff);
  position: relative;
  display: block;
  border-bottom-left-radius: 10px;
  border-bottom-right-radius: 10px;
}

.editor-shell .editor-container.tree-view {
  border-radius: 0;
}

.editor-shell .editor-container.plain-text {
  border-top-left-radius: 10px;
  border-top-right-radius: 10px;
}

.editor-scroller {
  min-height: 95vh;
  max-width: 100%;
  border: 0;
  display: flex;
  position: relative;
  outline: 0;
  z-index: 0;
  resize: none;
}

.editor {
  flex: auto;
  max-width: 100%;
  position: relative;
  resize: none;
  z-index: -1;
}

.test-recorder-output {
  margin: 20px auto 20px auto;
  width: 100%;
}

pre {
  line-height: 1.1;
  background: #222;
  color: #fff;
  margin: 0;
  padding: 10px;
  font-size: 12px;
  overflow: auto;
  max-height: 400px;
}

.tree-view-output {
  display: block;
  background: #222;
  color: #fff;
  padding: 0;
  font-size: 12px;
  margin: 1px auto 10px auto;
  position: relative;
  overflow: hidden;
  border-bottom-left-radius: 10px;
  border-bottom-right-radius: 10px;
}

pre::-webkit-scrollbar {
  background: transparent;
  width: 10px;
}

pre::-webkit-scrollbar-thumb {
  background: #999;
}

.editor-dev-button {
  position: relative;
  display: block;
  width: 40px;
  height: 40px;
  font-size: 12px;
  border-radius: 20px;
  border: none;
  cursor: pointer;
  outline: none;
  box-shadow: 0px 1px 10px rgba(0, 0, 0, 0.3);
  background-color: #444;
}

.editor-dev-button::after {
  content: '';
  position: absolute;
  top: 10px;
  right: 10px;
  bottom: 10px;
  left: 10px;
  display: block;
  background-size: contain;
  filter: invert(1);
}

.editor-dev-button:hover {
  background-color: #555;
}

.editor-dev-button.active {
  background-color: rgb(233, 35, 35);
}

.test-recorder-toolbar {
  display: flex;
}

.test-recorder-button {
  position: relative;
  display: block;
  width: 32px;
  height: 32px;
  font-size: 10px;
  padding: 6px 6px;
  border-radius: 4px;
  border: none;
  cursor: pointer;
  outline: none;
  box-shadow: 1px 2px 2px rgba(0, 0, 0, 0.4);
  background-color: #222;
  transition: box-shadow 50ms ease-out;
}

.test-recorder-button:active {
  box-shadow: 1px 2px 4px rgba(0, 0, 0, 0.4);
}

.test-recorder-button+.test-recorder-button {
  margin-left: 4px;
}

.test-recorder-button::after {
  content: '';
  position: absolute;
  top: 8px;
  right: 8px;
  bottom: 8px;
  left: 8px;
  display: block;
  background-size: contain;
  filter: invert(1);
}

#options-button {
  position: fixed;
  left: 20px;
  bottom: 20px;
}

#test-recorder-button {
  position: fixed;
  left: 70px;
  bottom: 20px;
}

#paste-log-button {
  position: fixed;
  left: 120px;
  bottom: 20px;
}

#docs-button {
  position: fixed;
  left: 170px;
  bottom: 20px;
}

#options-button::after {
  background-image: url(images/icons/gear.svg);
}

#test-recorder-button::after {
  background-image: url(images/icons/journal-code.svg);
}

#paste-log-button::after {
  background-image: url(images/icons/clipboard.svg);
}

#docs-button::after {
  background-image: url(images/icons/file-earmark-text.svg);
}

#test-recorder-button-snapshot {
  margin-right: auto;
}

#test-recorder-button-snapshot::after {
  background-image: url(images/icons/camera.svg);
}

#test-recorder-button-copy::after {
  background-image: url(images/icons/clipboard.svg);
}

#test-recorder-button-download::after {
  background-image: url(images/icons/download.svg);
}

.typeahead-popover {
  background: #fff;
  box-shadow: 0px 5px 10px rgba(0, 0, 0, 0.3);
  border-radius: 8px;
  position: relative;
}

.typeahead-popover ul {
  padding: 0;
  list-style: none;
  margin: 0;
  border-radius: 8px;
  max-height: 200px;
  overflow-y: scroll;
}

.typeahead-popover ul::-webkit-scrollbar {
  display: none;
}

.typeahead-popover ul {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

.typeahead-popover ul li {
  margin: 0;
  min-width: 180px;
  font-size: 14px;
  outline: none;
  cursor: pointer;
  border-radius: 8px;
}

.typeahead-popover ul li.selected {
  background: #eee;
}

.typeahead-popover li {
  margin: 0 8px 0 8px;
  padding: 8px;
  color: #050505;
  cursor: pointer;
  line-height: 16px;
  font-size: 15px;
  display: flex;
  align-content: center;
  flex-direction: row;
  flex-shrink: 0;
  background-color: #fff;
  border-radius: 8px;
  border: 0;
}

.typeahead-popover li.active {
  display: flex;
  width: 20px;
  height: 20px;
  background-size: contain;
}

.typeahead-popover li:first-child {
  border-radius: 8px 8px 0px 0px;
}

.typeahead-popover li:last-child {
  border-radius: 0px 0px 8px 8px;
}

.typeahead-popover li:hover {
  background-color: #eee;
}

.typeahead-popover li .text {
  display: flex;
  line-height: 20px;
  flex-grow: 1;
  min-width: 150px;
}

.typeahead-popover li .icon {
  display: flex;
  width: 20px;
  height: 20px;
  user-select: none;
  margin-right: 8px;
  line-height: 16px;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
}

.component-picker-menu {
  width: 200px;
}

.mentions-menu {
  width: 250px;
}

.auto-embed-menu {
  width: 150px;
}

.emoji-menu {
  width: 200px;
}

i.palette {
  background-image: url(images/icons/palette.svg);
}

i.bucket {
  background-image: url(images/icons/paint-bucket.svg);
}

i.bold {
  background-image: url(images/icons/type-bold.svg);
}

i.italic {
  background-image: url(images/icons/type-italic.svg);
}

i.clear {
  background-image: url(images/icons/trash.svg);
}

i.code {
  background-image: url(images/icons/code.svg);
}

i.underline {
  background-image: url(images/icons/type-underline.svg);
}

i.uppercase {
  background-image: url(images/icons/type-uppercase.svg);
}

i.lowercase {
  background-image: url(images/icons/type-lowercase.svg);
}

i.capitalize {
  background-image: url(images/icons/type-capitalize.svg);
}

i.strikethrough {
  background-image: url(images/icons/type-strikethrough.svg);
}

i.subscript {
  background-image: url(images/icons/type-subscript.svg);
}

i.superscript {
  background-image: url(images/icons/type-superscript.svg);
}

i.highlight {
  background-image: url(images/icons/highlighter.svg);
}

i.link {
  background-image: url(images/icons/link.svg);
}

i.horizontal-rule {
  background-image: url(images/icons/horizontal-rule.svg);
}

.icon.plus {
  background-image: url(images/icons/plus.svg);
}

.icon.caret-right {
  background-image: url(images/icons/caret-right-fill.svg);
}

.icon.dropdown-more {
  background-image: url(images/icons/dropdown-more.svg);
}

.icon.font-color {
  background-image: url(images/icons/font-color.svg);
}

.icon.font-family {
  background-image: url(images/icons/font-family.svg);
}

.icon.bg-color {
  background-image: url(images/icons/bg-color.svg);
}

.icon.table {
  background-color: #6c757d;
  mask-image: url(images/icons/table.svg);
  -webkit-mask-image: url(images/icons/table.svg);
  mask-repeat: no-repeat;
  -webkit-mask-repeat: no-repeat;
  mask-size: contain;
  -webkit-mask-size: contain;
}

i.image {
  background-image: url(images/icons/file-image.svg);
}

i.table {
  background-image: url(images/icons/table.svg);
}

i.close {
  background-image: url(images/icons/close.svg);
}

i.figma {
  background-image: url(images/icons/figma.svg);
}

i.poll {
  background-image: url(images/icons/card-checklist.svg);
}

i.columns {
  background-image: url(images/icons/3-columns.svg);
}

i.x {
  background-image: url(images/icons/x.svg);
}

i.youtube {
  background-image: url(images/icons/youtube.svg);
}

.icon.left-align,
i.left-align {
  background-image: url(images/icons/text-left.svg);
}

.icon.center-align,
i.center-align {
  background-image: url(images/icons/text-center.svg);
}

.icon.right-align,
i.right-align {
  background-image: url(images/icons/text-right.svg);
}

.icon.justify-align,
i.justify-align {
  background-image: url(images/icons/justify.svg);
}

.icon.vertical-top,
i.left-align {
  background-image: url(images/icons/vertical-top.svg);
}

.icon.vertical-middle,
i.center-align {
  background-image: url(images/icons/vertical-middle.svg);
}

.icon.vertical-bottom,
i.right-align {
  background-image: url(images/icons/vertical-bottom.svg);
}

i.indent {
  background-image: url(images/icons/indent.svg);
}

i.markdown {
  background-image: url(images/icons/markdown.svg);
}

i.outdent {
  background-image: url(images/icons/outdent.svg);
}

i.undo {
  background-image: url(images/icons/arrow-counterclockwise.svg);
}

i.redo {
  background-image: url(images/icons/arrow-clockwise.svg);
}

i.sticky {
  background-image: url(images/icons/sticky.svg);
}

i.mic {
  background-image: url(images/icons/mic.svg);
}

i.import {
  background-image: url(images/icons/upload.svg);
}

i.export {
  background-image: url(images/icons/download.svg);
}

i.share {
  background-image: url(images/icons/send.svg);
}

i.diagram-2 {
  background-image: url(images/icons/diagram-2.svg);
}

i.user {
  background-image: url(images/icons/user.svg);
}

i.equation {
  background-image: url(images/icons/plus-slash-minus.svg);
}

i.calendar {
  background-image: url(images/icons/calendar.svg);
}

i.gif {
  background-image: url(images/icons/filetype-gif.svg);
}

i.copy {
  background-image: url(images/icons/copy.svg);
}

i.paste {
  background-image: url(images/icons/clipboard.svg);
}

i.success {
  background-image: url(images/icons/success.svg);
}

i.prettier {
  background-image: url(images/icons/prettier.svg);
}

i.prettier-error {
  background-image: url(images/icons/prettier-error.svg);
}

i.page-break,
.icon.page-break {
  background-image: url(images/icons/scissors.svg);
}

.link-editor .button.active,
.toolbar .button.active {
  background-color: rgb(223, 232, 250);
}

.link-editor .link-input {
  display: block;
  width: calc(100% - 75px);
  box-sizing: border-box;
  margin: 12px 12px;
  padding: 8px 12px;
  border-radius: 15px;
  background-color: #eee;
  font-size: 15px;
  color: rgb(5, 5, 5);
  border: 0;
  outline: 0;
  position: relative;
  font-family: inherit;
}

.link-editor .link-view {
  display: block;
  width: calc(100% - 24px);
  margin: 8px 12px;
  padding: 8px 12px;
  border-radius: 15px;
  font-size: 15px;
  color: rgb(5, 5, 5);
  border: 0;
  outline: 0;
  position: relative;
  font-family: inherit;
}

.link-editor .link-view a {
  display: block;
  word-break: break-word;
  width: calc(100% - 33px);
}

.link-editor div.link-edit {
  background-image: url(images/icons/pencil-fill.svg);
  background-size: 16px;
  background-position: center;
  background-repeat: no-repeat;
  width: 35px;
  vertical-align: -0.25em;
  position: absolute;
  right: 30px;
  top: 0;
  bottom: 0;
  cursor: pointer;
}

.link-editor div.link-trash {
  background-image: url(images/icons/trash.svg);
  background-size: 16px;
  background-position: center;
  background-repeat: no-repeat;
  width: 35px;
  vertical-align: -0.25em;
  position: absolute;
  right: 0;
  top: 0;
  bottom: 0;
  cursor: pointer;
}

.link-editor div.link-cancel {
  background-image: url(images/icons/close.svg);
  background-size: 16px;
  background-position: center;
  background-repeat: no-repeat;
  width: 35px;
  vertical-align: -0.25em;
  margin-right: 28px;
  position: absolute;
  right: 0;
  top: 0;
  bottom: 0;
  cursor: pointer;
}

.link-editor div.link-confirm {
  background-image: url(images/icons/success-alt.svg);
  background-size: 16px;
  background-position: center;
  background-repeat: no-repeat;
  width: 35px;
  vertical-align: -0.25em;
  margin-right: 2px;
  position: absolute;
  right: 0;
  top: 0;
  bottom: 0;
  cursor: pointer;
}

.link-editor .link-input a {
  color: rgb(33, 111, 219);
  text-decoration: underline;
  white-space: nowrap;
  overflow: hidden;
  margin-right: 30px;
  text-overflow: ellipsis;
}

.link-editor .link-input a:hover {
  text-decoration: underline;
}

.link-editor .font-size-wrapper,
.link-editor .font-family-wrapper {
  display: flex;
  margin: 0 4px;
}

.link-editor select {
  padding: 6px;
  border: none;
  background-color: rgba(0, 0, 0, 0.075);
  border-radius: 4px;
}

.mention:focus {
  box-shadow: rgb(180 213 255) 0px 0px 0px 2px;
  outline: none;
}

.characters-limit {
  color: #888;
  font-size: 12px;
  text-align: right;
  display: block;
  position: absolute;
  left: 12px;
  bottom: 5px;
}

.characters-limit.characters-limit-exceeded {
  color: red;
}

.dropdown {
  z-index: 100;
  display: block;
  position: fixed;
  box-shadow:
    0 12px 28px 0 rgba(0, 0, 0, 0.2),
    0 2px 4px 0 rgba(0, 0, 0, 0.1),
    inset 0 0 0 1px rgba(255, 255, 255, 0.5);
  border-radius: 8px;
  min-height: 40px;
  background-color: #fff;
}

.dropdown .item {
  margin: 0 8px 0 8px;
  padding: 8px;
  color: #050505;
  cursor: pointer;
  line-height: 16px;
  font-size: 15px;
  display: flex;
  align-content: center;
  flex-direction: row;
  flex-shrink: 0;
  justify-content: space-between;
  background-color: #fff;
  border-radius: 8px;
  border: 0;
  max-width: 264px;
  min-width: 100px;
}

.dropdown .item.wide {
  align-items: center;
  width: 260px;
}

.dropdown .item.wide .icon-text-container {
  display: flex;

  .text {
    min-width: 120px;
  }
}

.dropdown .item .shortcut {
  color: #939393;
  align-self: flex-end;
}

.dropdown .item .active {
  display: flex;
  width: 20px;
  height: 20px;
  background-size: contain;
}

.dropdown .item:first-child {
  margin-top: 8px;
}

.dropdown .item:last-child {
  margin-bottom: 8px;
}

.dropdown .item:hover {
  background-color: #eee;
}

.dropdown .item .text {
  display: flex;
  line-height: 20px;
  flex-grow: 1;
  min-width: 150px;
}

.dropdown .item .icon {
  display: flex;
  width: 20px;
  height: 20px;
  user-select: none;
  margin-right: 12px;
  line-height: 16px;
  background-size: contain;
  background-position: center;
  background-repeat: no-repeat;
}

.dropdown .divider {
  width: auto;
  background-color: #eee;
  margin: 4px 8px;
  height: 1px;
}

@media screen and (max-width: 1100px) {
  .dropdown-button-text {
    display: none !important;
  }

  .dialog-dropdown>.dropdown-button-text {
    display: flex !important;
  }

  .font-size .dropdown-button-text {
    display: flex !important;
  }

  .code-language .dropdown-button-text {
    display: flex !important;
  }
}

.icon.paragraph {
  background-image: url(images/icons/text-paragraph.svg);
}

.icon.h1 {
  background-image: url(images/icons/type-h1.svg);
}

.icon.h2 {
  background-image: url(images/icons/type-h2.svg);
}

.icon.h3 {
  background-image: url(images/icons/type-h3.svg);
}

.icon.h4 {
  background-image: url(images/icons/type-h4.svg);
}

.icon.h5 {
  background-image: url(images/icons/type-h5.svg);
}

.icon.h6 {
  background-image: url(images/icons/type-h6.svg);
}

.icon.bullet-list,
.icon.bullet {
  background-image: url(images/icons/list-ul.svg);
}

.icon.check-list,
.icon.check {
  background-image: url(images/icons/square-check.svg);
}

.icon.numbered-list,
.icon.number {
  background-image: url(images/icons/list-ol.svg);
}

.icon.quote {
  background-image: url(images/icons/chat-square-quote.svg);
}

.icon.code {
  background-image: url(images/icons/code.svg);
}

.switches {
  z-index: 6;
  position: fixed;
  left: 10px;
  bottom: 70px;
  animation: slide-in 0.4s ease;
}

@keyframes slide-in {
  0% {
    opacity: 0;
    transform: translateX(-200px);
  }

  100% {
    opacity: 1;
    transform: translateX(0);
  }
}

.switch {
  display: block;
  color: #444;
  margin: 5px 0;
  background-color: rgba(238, 238, 238, 0.7);
  padding: 5px 10px;
  border-radius: 10px;
}

#rich-text-switch {
  right: 0;
}

#character-count-switch {
  right: 130px;
}

.switch label {
  margin-right: 5px;
  line-height: 14px;
  width: 100px;
  font-size: 12px;
  display: inline-block;
  vertical-align: middle;
}

.switch button {
  background-color: rgb(206, 208, 212);
  height: 24px;
  box-sizing: border-box;
  border-radius: 12px;
  width: 44px;
  display: inline-block;
  vertical-align: middle;
  position: relative;
  outline: none;
  cursor: pointer;
  transition: background-color 0.1s;
  border: 2px solid transparent;
}

.switch button:focus-visible {
  border-color: blue;
}

.switch button span {
  top: 0px;
  left: 0px;
  display: block;
  position: absolute;
  width: 20px;
  height: 20px;
  border-radius: 12px;
  background-color: white;
  transition: transform 0.2s;
}

.switch button[aria-checked='true'] {
  background-color: rgb(24, 119, 242);
}

.switch button[aria-checked='true'] span {
  transform: translateX(20px);
}

.editor-shell span.editor-image {
  cursor: default;
  display: inline-block;
  position: relative;
  user-select: none;
  overflow: hidden;
}

.editor-shell .editor-image img {
  max-width: 100%;
  cursor: default;
}

.editor-shell .editor-image img.focused {
  outline: 2px solid rgb(60, 132, 244);
  user-select: none;
}

.editor-shell .editor-image img.focused.draggable {
  cursor: grab;
}

.editor-shell .editor-image img.focused.draggable:active {
  cursor: grabbing;
}

.editor-shell .editor-image .image-caption-container .tree-view-output {
  margin: 0;
  border-radius: 0;
}

.editor-shell .editor-image .image-caption-container {
  display: block;
  position: absolute;
  bottom: 4px;
  left: 0;
  right: 0;
  padding: 0;
  margin: 0;
  border-top: 1px solid #fff;
  background-color: rgba(255, 255, 255, 0.9);
  min-width: 100px;
  color: #000;
  overflow: hidden;
  box-sizing: border-box;
  max-width: 100%;
  word-wrap: break-word;
}

.editor-shell .editor-image .image-caption-button {
  display: block;
  position: absolute;
  bottom: 20px;
  left: 0;
  right: 0;
  width: 30%;
  padding: 10px;
  margin: 0 auto;
  border: 1px solid rgba(255, 255, 255, 0.3);
  border-radius: 5px;
  background-color: rgba(0, 0, 0, 0.5);
  min-width: 100px;
  color: #fff;
  cursor: pointer;
  user-select: none;
}

.editor-shell .editor-image .image-caption-button:hover {
  background-color: rgba(60, 132, 244, 0.5);
}

.editor-shell .editor-image .image-edit-button {
  border: 1px solid rgba(0, 0, 0, 0.3);
  border-radius: 5px;
  background-image: url(/src/images/icons/pencil-fill.svg);
  background-size: 16px;
  background-position: center;
  background-repeat: no-repeat;
  width: 35px;
  height: 35px;
  vertical-align: -0.25em;
  position: absolute;
  right: 4px;
  top: 4px;
  cursor: pointer;
  user-select: none;
}

.editor-shell .editor-image .image-edit-button:hover {
  background-color: rgba(60, 132, 244, 0.1);
}

.editor-shell .editor-image .image-resizer {
  display: block;
  width: 7px;
  height: 7px;
  position: absolute;
  background-color: rgb(60, 132, 244);
  border: 1px solid #fff;
}

.editor-shell .editor-image .image-resizer.image-resizer-n {
  top: -6px;
  left: 48%;
  cursor: n-resize;
}

.editor-shell .editor-image .image-resizer.image-resizer-ne {
  top: -6px;
  right: -6px;
  cursor: ne-resize;
}

.editor-shell .editor-image .image-resizer.image-resizer-e {
  bottom: 48%;
  right: -6px;
  cursor: e-resize;
}

.editor-shell .editor-image .image-resizer.image-resizer-se {
  bottom: -2px;
  right: -6px;
  cursor: nwse-resize;
}

.editor-shell .editor-image .image-resizer.image-resizer-s {
  bottom: -2px;
  left: 48%;
  cursor: s-resize;
}

.editor-shell .editor-image .image-resizer.image-resizer-sw {
  bottom: -2px;
  left: -6px;
  cursor: sw-resize;
}

.editor-shell .editor-image .image-resizer.image-resizer-w {
  bottom: 48%;
  left: -6px;
  cursor: w-resize;
}

.editor-shell .editor-image .image-resizer.image-resizer-nw {
  top: -6px;
  left: -6px;
  cursor: nw-resize;
}

.emoji {
  color: transparent;
  caret-color: rgb(5, 5, 5);
  background-size: 16px 16px;
  background-position: center;
  background-repeat: no-repeat;
  vertical-align: middle;
  margin: 0 -1px;
}

.emoji-inner {
  padding: 0 0.15em;
}

.emoji-inner::selection {
  color: transparent;
  background-color: rgba(150, 150, 150, 0.4);
}

.emoji-inner::moz-selection {
  color: transparent;
  background-color: rgba(150, 150, 150, 0.4);
}

.emoji.happysmile {
  background-image: url(images/emoji/1F642.png);
}

.emoji.veryhappysmile {
  background-image: url(images/emoji/1F600.png);
}

.emoji.unhappysmile {
  background-image: url(images/emoji/1F641.png);
}

.emoji.heart {
  background-image: url(images/emoji/2764.png);
}

.keyword {
  color: rgb(241, 118, 94);
  font-weight: bold;
}

.actions {
  position: absolute;
  text-align: right;
  margin: 10px;
  bottom: 0;
  right: 0;
}

.actions.tree-view {
  border-bottom-left-radius: 0;
  border-bottom-right-radius: 0;
}

.actions i {
  background-size: contain;
  display: inline-block;
  height: 15px;
  width: 15px;
  vertical-align: -0.25em;
}

.actions i.indent {
  background-image: url(images/icons/indent.svg);
}

.actions i.outdent {
  background-image: url(images/icons/outdent.svg);
}

.actions i.lock {
  background-image: url(images/icons/lock-fill.svg);
}

.actions i.image {
  background-image: url(images/icons/file-image.svg);
}

.actions i.table {
  background-image: url(images/icons/table.svg);
}

.actions i.unlock {
  background-image: url(images/icons/lock.svg);
}

.actions i.left-align {
  background-image: url(images/icons/text-left.svg);
}

.actions i.center-align {
  background-image: url(images/icons/text-center.svg);
}

.actions i.right-align {
  background-image: url(images/icons/text-right.svg);
}

.actions i.justify-align {
  background-image: url(images/icons/justify.svg);
}

.actions i.disconnect {
  background-image: url(images/icons/plug.svg);
}

.actions i.connect {
  background-image: url(images/icons/plug-fill.svg);
}

.actions i.versions {
  background-image: url(images/icons/clock-history.svg);
}

.table-cell-action-button-container {
  position: absolute;
  z-index: 3;
  top: 0;
  left: 0;
  will-change: transform;
}

.table-cell-action-button-container.table-cell-action-button-container--active {
  pointer-events: auto;
  opacity: 1;
}

.table-cell-action-button-container.table-cell-action-button-container--inactive {
  pointer-events: none;
  opacity: 0;
}

.table-cell-action-button {
  display: flex;
  justify-content: center;
  align-items: center;
  border: 0;
  position: absolute;
  top: 10px;
  right: 10px;
  border-radius: 15px;
  color: #222;
  display: inline-block;
  cursor: pointer;
}

i.chevron-down {
  background-color: transparent;
  background-size: contain;
  display: inline-block;
  height: 8px;
  width: 8px;
  background-image: url(images/icons/chevron-down.svg);
}

.action-button {
  background-color: #eee;
  border: 0;
  padding: 8px 12px;
  position: relative;
  margin-left: 5px;
  border-radius: 15px;
  color: #222;
  display: inline-block;
  cursor: pointer;
}

.action-button:hover {
  background-color: #ddd;
  color: #000;
}

.action-button-mic.active {
  animation: mic-pulsate-color 3s infinite;
}

button.action-button:disabled {
  opacity: 0.6;
  background: #eee;
  cursor: not-allowed;
}

@keyframes mic-pulsate-color {
  0% {
    background-color: #ffdcdc;
  }

  50% {
    background-color: #ff8585;
  }

  100% {
    background-color: #ffdcdc;
  }
}

.debug-timetravel-panel {
  overflow: hidden;
  padding: 0 0 10px 0;
  margin: auto;
  display: flex;
}

.debug-timetravel-panel-slider {
  padding: 0;
  flex: 8;
}

.debug-timetravel-panel-button {
  padding: 0;
  border: 0;
  background: none;
  flex: 1;
  color: #fff;
  font-size: 12px;
}

.debug-timetravel-panel-button:hover {
  text-decoration: underline;
}

.debug-timetravel-button {
  border: 0;
  padding: 0;
  font-size: 12px;
  top: 10px;
  right: 15px;
  position: absolute;
  background: none;
  color: #fff;
}

.debug-timetravel-button:hover {
  text-decoration: underline;
}

.debug-treetype-button {
  border: 0;
  padding: 0;
  font-size: 12px;
  top: 10px;
  right: 85px;
  position: absolute;
  background: none;
  color: #fff;
}

.debug-treetype-button:hover {
  text-decoration: underline;
}

.connecting {
  font-size: 15px;
  color: #999;
  overflow: hidden;
  position: absolute;
  text-overflow: ellipsis;
  top: 10px;
  left: 10px;
  user-select: none;
  white-space: nowrap;
  display: inline-block;
  pointer-events: none;
}

.toolbar {
  display: flex;
  margin-bottom: 1px;
  background: #fff;
  padding: 4px;
  border-top-left-radius: 10px;
  border-top-right-radius: 10px;
  vertical-align: middle;
  overflow: auto;
  height: 36px;
  position: sticky;
  top: 0;
  z-index: 2;
  overflow-y: hidden;
  /* disable vertical scroll*/
}

.toolbar .toolbar-item:focus {
  outline: 2px solid rgb(60, 132, 244);
}

button.toolbar-item {
  border: 0;
  display: flex;
  background: none;
  border-radius: 10px;
  padding: 8px;
  cursor: pointer;
  vertical-align: middle;
  flex-shrink: 0;
  align-items: center;
  justify-content: space-between;
}

button.toolbar-item:disabled {
  cursor: not-allowed;
}

button.toolbar-item.spaced {
  margin-right: 2px;
}

button.toolbar-item i.format {
  background-size: contain;
  display: inline-block;
  height: 18px;
  width: 18px;
  vertical-align: -0.25em;
  display: flex;
  opacity: 0.6;
}

button.toolbar-item:disabled .icon,
button.toolbar-item:disabled .text,
button.toolbar-item:disabled i.format,
button.toolbar-item:disabled .chevron-down {
  opacity: 0.2;
}

button.toolbar-item.active {
  background-color: rgba(223, 232, 250, 0.3);
}

button.toolbar-item.active i {
  opacity: 1;
}

.toolbar-item:hover:not([disabled]) {
  background-color: #eee;
}

.toolbar-item.font-family .text {
  display: block;
  max-width: 40px;
}

.toolbar .code-language {
  width: 150px;
}

.toolbar .toolbar-item .text {
  display: flex;
  line-height: 20px;
  vertical-align: middle;
  font-size: 14px;
  color: #777;
  text-overflow: ellipsis;
  overflow: hidden;
  height: 20px;
  text-align: left;
  padding-right: 10px;
}

.toolbar .toolbar-item .icon {
  display: flex;
  width: 20px;
  height: 20px;
  user-select: none;
  margin-right: 8px;
  line-height: 16px;
  background-size: contain;
}

.toolbar i.chevron-down,
.toolbar-item i.chevron-down {
  margin-top: 3px;
  width: 16px;
  height: 16px;
  display: flex;
  user-select: none;
}

.toolbar i.chevron-down.inside {
  width: 16px;
  height: 16px;
  display: flex;
  margin-left: -25px;
  margin-top: 11px;
  margin-right: 10px;
  pointer-events: none;
}

.toolbar .divider {
  width: 1px;
  background-color: #eee;
  margin: 0 4px;
}

.sticky-note-container {
  position: absolute;
  z-index: 9;
  width: 120px;
  display: inline-block;
}

.sticky-note {
  line-height: 1;
  text-align: left;
  width: 120px;
  margin: 25px;
  padding: 20px 10px;
  position: relative;
  border: 1px solid #e8e8e8;
  font-family: 'Reenie Beanie';
  font-size: 24px;
  border-bottom-right-radius: 60px 5px;
  display: block;
  cursor: move;
}

.sticky-note:after {
  content: '';
  position: absolute;
  z-index: -1;
  right: -0px;
  bottom: 20px;
  width: 120px;
  height: 25px;
  background: rgba(0, 0, 0, 0.2);
  box-shadow: 2px 15px 5px rgba(0, 0, 0, 0.4);
  transform: matrix(-1, -0.1, 0, 1, 0, 0);
}

.sticky-note.yellow {
  border-top: 1px solid #fdfd86;
  background: linear-gradient(135deg,
      #ffff88 81%,
      #ffff88 82%,
      #ffff88 82%,
      #ffffc6 100%);
}

.sticky-note.pink {
  border-top: 1px solid #e7d1e4;
  background: linear-gradient(135deg,
      #f7cbe8 81%,
      #f7cbe8 82%,
      #f7cbe8 82%,
      #e7bfe1 100%);
}

.sticky-note-container.dragging {
  transition: none !important;
}

.sticky-note div {
  cursor: text;
}

.sticky-note .delete {
  border: 0;
  background: none;
  position: absolute;
  top: 8px;
  right: 10px;
  font-size: 10px;
  cursor: pointer;
  opacity: 0.5;
}

.sticky-note .delete:hover {
  font-weight: bold;
  opacity: 1;
}

.sticky-note .color {
  border: 0;
  background: none;
  position: absolute;
  top: 8px;
  right: 25px;
  cursor: pointer;
  opacity: 0.5;
}

.sticky-note .color:hover {
  opacity: 1;
}

.sticky-note .color i {
  display: block;
  width: 12px;
  height: 12px;
  background-size: contain;
}

.excalidraw-button {
  border: 0;
  padding: 0;
  margin: 0;
  background-color: transparent;
}

.excalidraw-button.selected {
  outline: 2px solid rgb(60, 132, 244);
  user-select: none;
}

.github-corner:hover .octo-arm {
  animation: octocat-wave 560ms ease-in-out;
}

@keyframes octocat-wave {

  0%,
  100% {
    transform: rotate(0);
  }

  20%,
  60% {
    transform: rotate(-25deg);
  }

  40%,
  80% {
    transform: rotate(10deg);
  }
}

@media (max-width: 500px) {
  .github-corner:hover .octo-arm {
    animation: none;
  }

  .github-corner .octo-arm {
    animation: octocat-wave 560ms ease-in-out;
  }
}

.spacer {
  letter-spacing: -2px;
}

.editor-equation {
  cursor: default;
  user-select: none;
}

.editor-equation.focused {
  outline: 2px solid rgb(60, 132, 244);
}

button.item i {
  opacity: 0.6;
}

button.item.dropdown-item-active {
  background-color: rgba(223, 232, 250, 0.3);
}

button.item.dropdown-item-active i {
  opacity: 1;
}

.TableNode__contentEditable {
  min-height: 20px;
  border: 0px;
  resize: none;
  cursor: text;
  display: block;
  position: relative;
  outline: 0px;
  padding: 0;
  user-select: text;
  font-size: 18px;
  white-space: pre-wrap;
  word-break: break-word;
  z-index: 3;
}

.dialog-dropdown {
  background-color: #eee !important;
  margin-bottom: 10px;
  width: 100%;
}

.toolbar .block-controls {
  display: flex;
  align-items: center;
}

.toolbar .block-controls .dropdown-button-text {
  width: 7em;
  text-align: left;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  display: inline-block;
}

/* Image Resizer Styles - Moved from ImageNode.css to ensure loading */
.image-control-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  /* Important: allow clicking through to image */
}

.image-resizer {
  display: block;
  width: 10px;
  height: 10px;
  position: absolute;
  background-color: rgb(60, 132, 244);
  border: 1px solid #fff;
  z-index: 10;
  /* Ensure explicitly high z-index */
  pointer-events: auto;
  /* Enable clicking on handles */
}

.image-resizer-n {
  top: -6px;
  left: 48%;
  cursor: n-resize;
}

.image-resizer-ne {
  top: -6px;
  right: -6px;
  cursor: ne-resize;
}

.image-resizer-e {
  bottom: 48%;
  right: -6px;
  cursor: e-resize;
}

.image-resizer-se {
  bottom: -6px;
  right: -6px;
  cursor: se-resize;
}

.image-resizer-s {
  bottom: -6px;
  left: 48%;
  cursor: s-resize;
}

.image-resizer-sw {
  bottom: -6px;
  left: -6px;
  cursor: sw-resize;
}

.image-resizer-w {
  bottom: 48%;
  left: -6px;
  cursor: w-resize;
}

.image-resizer-nw {
  top: -6px;
  left: -6px;
  cursor: nw-resize;
}

.editor-image {
  display: inline-block;
  position: relative;
}

.editor-image.focused {
  outline: 2px solid rgb(60, 132, 244);
  user-select: none;
}

/* --- FINAL CONSOLIDATED IMAGE STYLES --- */

/* 1. Outer Node Container: Flow like water (text) */
.editor-image {
  display: inline !important;
  width: auto !important;
  margin: 0 !important;
  padding: 0 !important;
  line-height: inherit !important;
  vertical-align: baseline !important;
  /* Align image bottom with text baseline for visual perfection */
  white-space: normal;
}

/* 2. Inner Component Wrapper: Structure like stone (box) */
.image-wrapper {
  display: inline-block !important;
  /* inline-block handles cursor height better than flex */
  position: relative !important;
  width: auto !important;
  max-width: 100% !important;
  height: auto !important;
  margin: 0 4px !important;
  /* Keep margin for cursor visibility */
  vertical-align: baseline !important;
  /* Align baseline */
}

/* 2.1 Protect Child Text (e.g. Buttons) */
.image-wrapper button,
.image-wrapper .text {
  font-size: 14px !important;
  /* Restore font size for UI elements */
  line-height: normal !important;
}

/* 3. Image Element */
.editor-image img {
  display: block !important;
  height: auto !important;
  max-width: 100% !important;
}

/* 4. Resizer Overlay: Exact fit */
.image-control-wrapper {
  position: absolute !important;
  inset: 0 !important;
  /* Top/Left/Right/Bottom: 0 */
  width: auto !important;
  height: auto !important;
  pointer-events: none;
  z-index: 10;
}

/* 5. Resizer Handles: High visibility & Inner Positioning */
.image-resizer {
  display: block;
  width: 8px !important;
  height: 8px !important;
  position: absolute;
  background-color: rgb(60, 132, 244);
  border: 1px solid white;
  box-shadow: 0 0 3px rgba(0, 0, 0, 0.5);
  z-index: 20;
  pointer-events: auto;
}

/* Position handles inset by 4px to ensure visibility */
.image-resizer-n {
  top: 4px !important;
  left: calc(50% - 4px) !important;
  cursor: n-resize;
}

.image-resizer-ne {
  top: 4px !important;
  right: 4px !important;
  cursor: ne-resize;
}

.image-resizer-e {
  bottom: calc(50% - 4px) !important;
  right: 4px !important;
  cursor: e-resize;
}

.image-resizer-se {
  bottom: 4px !important;
  right: 4px !important;
  cursor: se-resize;
}

.image-resizer-s {
  bottom: 4px !important;
  left: calc(50% - 4px) !important;
  cursor: s-resize;
}

.image-resizer-sw {
  bottom: 4px !important;
  left: 4px !important;
  cursor: sw-resize;
}

.image-resizer-w {
  bottom: calc(50% - 4px) !important;
  left: 4px !important;
  cursor: w-resize;
}

.image-resizer-nw {
  top: 4px !important;
  left: 4px !important;
  cursor: nw-resize;
}

/* 6. Focus Ring */
.editor-image.focused .image-wrapper {
  outline: 2px solid rgb(60, 132, 244);
  outline-offset: 1px;
}

/* =========================================
   VARIABLES & THEME CONFIGURATION
   ========================================= */
:root {
  --app-bg: #ffffff;
  --module-bg: #ffffff;
  --text-color: #1a1a1a;
  --border-color: #f0f0f0;
  --active-bg: #f5f5f5;
  --shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
  --gap-size: 12px;
}

@media (prefers-color-scheme: dark) {
  :root {
    --app-bg: #1c1c1e;
    --module-bg: #2c2c2e;
    --text-color: #ffffff;
    --border-color: rgba(255, 255, 255, 0.1);
    --active-bg: #404040;
    --shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
  }

  /* 默认文字跟随主题切换 */
  body,
  .ContentEditable__root,
  .editor-input,
  .todo-input {
    color: var(--text-color);
  }



  .icon,
  button.toolbar-item i,
  .editor-dev-button:after,
  .test-recorder-button:after,
  .new-note-btn svg {
    filter: invert(1);
  }

  button.toolbar-item.active i {
    filter: invert(1);
  }

  .new-note-btn {
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
  }
}

/* =========================================
   INACTIVE STATE (IDLE)
   ========================================= */
body.inactive .toolbar,
body.inactive .new-note-btn {
  box-shadow: none !important;
  background-color: #f7f7f7 !important;
  border: none !important;
}

@media (prefers-color-scheme: dark) {

  body.inactive .toolbar,
  body.inactive .new-note-btn {
    background-color: #252527 !important;
    border: none !important;
  }
}

/* =========================================
   LAYOUT ARCHITECTURE - RIGID RESET
   ========================================= */
html,
body {
  margin: 0 !important;
  padding: 0 !important;
  width: 100% !important;
  height: 100% !important;
  overflow: hidden !important;
  background-color: var(--app-bg) !important;
}

#root {
  margin: 0 !important;
  /* BASE 20px PADDING - CORE ANCHOR */
  padding: 4px 20px 24px 20px !important;
  width: 100% !important;
  height: 100% !important;
  display: flex !important;
  flex-direction: column !important;
  box-sizing: border-box !important;
  overflow-x: hidden !important;
  /* Strictly no horizontal overflow */
}

.editor-shell {
  margin: 0 !important;
  padding: 0 !important;
  width: 100% !important;
  height: 100% !important;
  /* Force height */
  display: flex !important;
  flex-direction: column !important;
  flex: 1 !important;
  align-items: stretch !important;
  /* Stretch children to fill width */
  box-sizing: border-box !important;
  min-height: 0 !important;
}


/* =========================================
   EDITOR CONTENT - PRECISION 44px PADDING
   ========================================= */
.editor-shell .editor-container {
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
  display: flex !important;
  flex-direction: column !important;
  flex: 1 !important;
  width: 100% !important;
  height: 100% !important;
  /* Force height */
  margin-top: 0px !important;
  padding: 0 !important;
  box-sizing: border-box !important;
  overflow: visible !important;
  min-height: 0 !important;
}

.editor-scroller {
  background-color: transparent !important;
  border: none !important;
  box-shadow: none !important;
  margin: 0 !important;

  /* Zero padding for strict alignment - relies on #root padding */
  padding: 0 !important;

  flex: 1 !important;
  display: flex !important;
  flex-direction: column !important;
  width: 100% !important;
  height: 100% !important;
  /* Force height */
  box-sizing: border-box !important;
  outline: none !important;

  /* ENABLE SCROLLING */
  overflow-y: auto !important;
  overflow-x: hidden !important;
  min-height: 0 !important;
}

.editor-input,
.ContentEditable__root,
[contenteditable] {
  flex: 1;
  min-height: 100%;
  padding: 0 !important;
  margin: 0 !important;
  width: 100% !important;
  box-sizing: border-box !important;
  outline: none !important;
  color: inherit;
}

.editor {
  flex: 1 !important;
  outline: none !important;
  width: 100% !important;
}

/* 系统层默认插入符颜色 */
.ContentEditable__root {
  caret-color: #007aff;
}

@media (prefers-color-scheme: dark) {
  .ContentEditable__root {
    caret-color: #ffffff;
  }
}

/* =========================================
   FEATURE TOGGLES - HIDE UNWANTED BUTTONS
   ========================================= */
.editor-placeholder {
  display: none !important;
}

button.toolbar-item:has(i.undo),
button.toolbar-item:has(i.redo) {
  display: none !important;
}

.font-size-input,
button.font-decrement,
button.font-increment,
button.toolbar-item:has(i.minus-icon),
button.toolbar-item:has(i.plus-icon) {
  display: none !important;
}

button.toolbar-item.font-family,
.font-family {
  display: none !important;
}

button.toolbar-item:has(i.code),
button.toolbar-item:has(i.link) {
  display: none !important;
}

.toolbar .divider {
  display: none !important;
}

.ContentEditable__root:focus,
[contenteditable]:focus {
  outline: none !important;
}

/* =========================================
   TODO VIEW
   ========================================= */
/* Todo View Style (Apple Reminders Look) */
.todo-view {
  flex: 1;
  width: 100% !important;
  display: flex !important;
  flex-direction: column !important;
  padding: 0 16px 10px 16px !important;
  /* Reasonable side padding */
  margin-top: 0 !important;
  animation: fadeInMode 0.3s ease-out;
  box-sizing: border-box !important;
  overflow-y: auto !important;
  overflow-x: hidden !important;
  min-height: 0;
}

.todo-input,
textarea {
  caret-color: #007aff !important;
  /* Apple Blue Caret */
}

@keyframes fadeInMode {
  from {
    opacity: 0;
    transform: translateY(10px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.todo-header {
  font-size: 28px;
  font-weight: 700;
  color: #007aff;
  margin-top: -8px !important;
  /* Pull up to align with visual top of sidebar button */
  margin-bottom: 0 !important;
  margin-left: -20px !important;
  margin-right: -20px !important;
  padding: 8px 20px 12px 20px;
  /* Add horizontal padding to compensate for negative margin */
  border-bottom: 1px solid var(--border-color);
  position: sticky;
  /* Make header sticky */
  top: -8px;
  /* Offset for the negative margin-top */
  z-index: 100;
  display: flex !important;
  flex-direction: column;
  /* Frosted glass effect */
  background: rgba(var(--bg-color-rgb, 255, 255, 255), 0.85);
  backdrop-filter: saturate(180%) blur(20px);
  -webkit-backdrop-filter: saturate(180%) blur(20px);
}

.todo-subheader {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  font-size: 13px;
  color: #8e8e93;
  margin-top: 2px;
  font-weight: normal;
  letter-spacing: -0.1px;
}

.todo-subheader-row {
  display: flex;
  align-items: center;
  width: 100%;
}

.todo-warning-msg {
  color: #ff3b30;
  font-size: 11px;
  margin-top: 0px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 100%;
  font-weight: 500;
  display: block;
  line-height: 1.1;
  /* Prevent height increase if possible */
  height: 0;
  overflow: visible;
}

.dot-separator {
  margin: 0 4px;
  color: #000;
  font-size: 10px;
}

.todo-clear-btn {
  background: none;
  border: none;
  padding: 0;
  font-size: 13px;
  font-weight: bold;
  color: #8e8e93;
  cursor: pointer;
  outline: none;
  transition: opacity 0.2s;
  display: inline-flex;
}

.todo-clear-btn .dropdown-button-text {
  display: flex !important;
}

.todo-clear-btn:hover {
  opacity: 0.7;
}

.todo-view .dropdown {
  min-width: 160px;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  padding: 4px;
  border: 0.5px solid rgba(0, 0, 0, 0.1);
  z-index: 2000;
}

.todo-view .dropdown .item {
  border-radius: 8px;
  padding: 8px 12px;
  font-size: 13px;
  color: #333;
  width: 100%;
  text-align: left;
  border: none;
  background: transparent;
  cursor: pointer;
}

.todo-view .dropdown .item:hover {
  background-color: #007aff;
  color: #fff;
}

@media (prefers-color-scheme: dark) {
  .todo-header {
    /* Dark mode frosted glass effect */
    background: rgba(30, 30, 30, 0.85);
    backdrop-filter: saturate(180%) blur(20px);
    -webkit-backdrop-filter: saturate(180%) blur(20px);
  }

  .todo-view .dropdown {
    background: rgba(45, 45, 45, 0.95);
    border-color: rgba(255, 255, 255, 0.1);
  }

  .todo-view .dropdown .item {
    color: #eee;
  }

  .dot-separator {
    color: #8e8e93;
  }
}


.todo-list {
  display: flex;
  flex-direction: column;
  width: 100%;
  padding-top: 10px;
  /* Specific gap for first item */
  flex: 1;
  /* Fill remaining vertical space */
}

/* Clickable fill area at the bottom */
.todo-fill-area {
  flex: 1;
  min-height: 100px;
  cursor: text;
  width: 100%;
}

.todo-row {
  display: flex;
  align-items: flex-start !important;
  /* Align with first line of multiline text */
  border-bottom: 1px solid var(--border-color);
  width: 100%;
  gap: 8px;
  transition: background 0.2s;
  /* Original Layout Restoration */
  margin: 0 !important;
  padding: 7px 12px 7px !important;
  /* Balanced 7px/7px padding - Move text UP from before */
  min-height: 0 !important;
  background: transparent !important;
  border-bottom: 1px solid var(--border-color) !important;
  /* Visible Separator Debug */
  /* Remove all height constraints */
  /* Restore min-height */
  height: auto !important;
  /* Restore auto height */
  /* Internal horizontal padding prevents circle truncation on hover */
  box-sizing: border-box !important;
}

.todo-row:hover {
  background-color: rgba(0, 122, 255, 0.03);
}

.todo-row.selected {
  background-color: rgba(0, 122, 255, 0.1) !important;
}

.todo-row.selected:hover {
  background-color: rgba(0, 122, 255, 0.15) !important;
}

/* Todo info button and icon management */
.info-btn {
  width: 20px;
  height: 20px;
  display: flex !important;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  cursor: pointer;
  color: #007aff;
  transition: background-color 0.2s, opacity 0.2s;
  flex-shrink: 0;
  background-color: transparent;
}

/* Background bubble removed - Match bell icon style */
.info-btn:hover,
.todo-row:hover .info-btn {
  background-color: transparent !important;
}

/* Icons are hidden by default */
.info-btn .info-icon-display,
.info-btn .bell-icon-display {
  display: none !important;
  pointer-events: none;
  /* Let clicks pass to the button */
}

/* Bell shows by default if has-reminder is present */
.info-btn.has-reminder .bell-icon-display {
  display: block !important;
}

/* On row hover: SWAP bell for info icon (ONLY if NOT ringing) */
.todo-row:hover .info-btn:not(.is-ringing) .bell-icon-display {
  display: none !important;
}

.todo-row:hover .info-btn:not(.is-ringing) .info-icon-display {
  display: block !important;
}

/* Ensure ringing bell stays visible even on hover */
.info-btn.is-ringing .bell-icon-display {
  display: block !important;
}

.info-btn.is-ringing .info-icon-display {
  display: none !important;
}

.todo-details-panel.apple-style .switch {
  background-color: transparent;
  padding: 0;
  margin: 0;
}

.todo-details-panel.apple-style .switch label {
  width: 0;
  margin: 0;
}

.todo-details-panel.apple-style .switch button {
  margin: 0;
}

.panel-icon-box {
  width: 28px;
  height: 28px;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.priority-prefix {
  color: #ff8d30;
  font-weight: bold;
}


/* Details Panel Styling (Apple Glassmorphism) */
.todo-details-panel-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: transparent;
  z-index: 3000;
}

.todo-details-panel.apple-style {
  position: absolute;
  top: 60px;
  right: 20px;
  width: 320px;
  background: rgba(254, 254, 254, 0.75);
  backdrop-filter: blur(40px) saturate(200%);
  -webkit-backdrop-filter: blur(40px) saturate(200%);
  border-radius: 12px;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.12), 0 0 0 0.5px rgba(0, 0, 0, 0.08);
  padding: 12px;
  display: flex;
  flex-direction: column;
  gap: 0;
  animation: apple-panel-in 0.35s cubic-bezier(0.16, 1, 0.3, 1);
}

@keyframes apple-panel-in {
  from {
    transform: scale(0.95);
    opacity: 0;
  }

  to {
    transform: scale(1);
    opacity: 1;
  }
}

.panel-section {
  padding: 8px 4px;
  transition: all 0.3s ease;
}

.panel-section.expanded {
  background: rgba(0, 0, 0, 0.03);
  margin: 4px -4px;
  padding: 8px 8px;
  border-radius: 10px;
}

.panel-row {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  gap: 10px;
  min-height: 40px;
  padding: 2px 0;
}

.panel-row.clickable {
  cursor: pointer;
}

.panel-icon-box {
  width: 28px;
  height: 28px;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.date-bg {
  background-color: #ff3b30;
}

.time-bg {
  background-color: #007aff;
}

.reminder-bg {
  background-color: #8e8e93;
}

.repeat-bg {
  background-color: #ccc;
}

.priority-bg {
  background-color: #ff9500;
}

.panel-icon {
  width: 16px;
  height: 16px;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  filter: brightness(0) invert(1);
}

.calendar-icon {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect x='3' y='4' width='18' height='18' rx='2' ry='2'%3E%3C/rect%3E%3Cline x1='16' y1='2' x2='16' y2='6'%3E%3C/line%3E%3Cline x1='8' y1='2' x2='8' y2='6'%3E%3C/line%3E%3Cline x1='3' y1='10' x2='21' y2='10'%3E%3C/line%3E%3C/svg%3E");
}

.clock-icon {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='10'%3E%3C/circle%3E%3Cpolyline points='12 6 12 12 16 14'%3E%3C/polyline%3E%3C/svg%3E");
}

.bell-icon {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9'%3E%3C/path%3E%3Cpath d='M13.73 21a2 2 0 0 1-3.46 0'%3E%3C/path%3E%3C/svg%3E");
}

.repeat-icon {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='17 1 21 5 17 9'%3E%3C/polyline%3E%3Cpath d='M3 11V9a4 4 0 0 1 4-4h14'%3E%3C/path%3E%3Cpolyline points='7 23 3 19 7 15'%3E%3C/polyline%3E%3Cpath d='M21 13v2a4 4 0 0 1-4 4H3'%3E%3C/path%3E%3C/svg%3E");
}

.priority-icon {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cline x1='12' y1='19' x2='12' y2='5'%3E%3C/line%3E%3Cpolyline points='5 12 12 5 19 12'%3E%3C/polyline%3E%3C/svg%3E");
}

.panel-label-group {
  display: flex;
  flex-direction: column;
  justify-content: center;
  flex-grow: 1;
}

.panel-label {
  font-size: 15px;
  color: #1a1a1a;
  font-weight: 400;
}

.panel-sub-label {
  font-size: 12px;
  color: #8e8e93;
}

.apple-select {
  border: none;
  background: transparent;
  color: #8e8e93;
  font-size: 15px;
  outline: none;
  cursor: pointer;
  text-align: right;
  text-align-last: right;
  min-width: 80px;
  flex-shrink: 0;
}

.apple-select option {
  text-align: right;
  direction: ltr;
}

.panel-divider {
  height: 0.5px;
  background-color: rgba(0, 0, 0, 0.1);
  margin: 8px 0;
}

.panel-expanded-picker {
  padding: 8px 0;
  display: flex;
  justify-content: center;
}

/* New Combined DateTime Picker */
.panel-datetime-picker {
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  background: rgba(0, 122, 255, 0.05);
  border-radius: 12px;
  margin: 8px 16px;
}

.datetime-picker-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.datetime-label {
  font-size: 14px;
  font-weight: 500;
  color: #333;
  min-width: 40px;
}

.datetime-input {
  flex: 1;
  max-width: 180px;
  border: none;
  background: rgba(255, 255, 255, 0.9);
  padding: 10px 14px;
  border-radius: 10px;
  font-size: 15px;
  color: #007aff;
  outline: none;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
  transition: box-shadow 0.2s ease;
}

.datetime-input:focus {
  box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.2);
}

.datetime-footer {
  display: flex;
  justify-content: flex-end;
  margin-top: 4px;
}

.datetime-confirm-btn {
  background: none;
  border: none;
  color: #007aff;
  font-size: 15px;
  font-weight: 600;
  padding: 6px 12px;
  border-radius: 6px;
  cursor: pointer;
  transition: background 0.15s ease;
}

.datetime-confirm-btn:hover {
  background: rgba(0, 122, 255, 0.1);
}

.datetime-confirm-btn:active {
  background: rgba(0, 122, 255, 0.2);
}

/* Circular Preview Button - matches switch height */
.panel-preview-btn-circle {
  width: 26px;
  height: 26px;
  border-radius: 50%;
  background: rgba(0, 122, 255, 0.1);
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  color: #007aff;
  transition: background 0.15s ease, transform 0.15s ease;
  margin-right: 8px;
  position: relative;
  align-self: center;
  flex-shrink: 0;
}

.panel-preview-btn-circle:hover {
  background: rgba(0, 122, 255, 0.2);
  transform: scale(1.05);
}

.panel-preview-btn-circle:active {
  transform: scale(0.95);
}

/* Custom instant tooltip */
.panel-preview-btn-circle::after {
  content: attr(title);
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0, 0, 0, 0.75);
  color: white;
  font-size: 11px;
  padding: 4px 8px;
  border-radius: 4px;
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.1s ease;
  margin-bottom: 4px;
}

.panel-preview-btn-circle:hover::after {
  opacity: 1;
}

/* Hide native title tooltip */
.panel-preview-btn-circle[title] {
  -webkit-user-select: none;
  user-select: none;
}

/* DateTime Icon Background */
.datetime-bg {
  background: linear-gradient(135deg, #ff6b6b 0%, #ff9f43 100%);
}

.calendar-clock-icon {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect x='3' y='4' width='18' height='18' rx='2' ry='2'%3E%3C/rect%3E%3Cline x1='16' y1='2' x2='16' y2='6'%3E%3C/line%3E%3Cline x1='8' y1='2' x2='8' y2='6'%3E%3C/line%3E%3Cline x1='3' y1='10' x2='21' y2='10'%3E%3C/line%3E%3Ccircle cx='12' cy='16' r='3'%3E%3C/circle%3E%3Cpolyline points='12 14 12 16 13 17'%3E%3C/polyline%3E%3C/svg%3E");
}

.apple-date-picker,
.apple-time-picker {
  border: none;
  background: rgba(0, 0, 0, 0.05);
  padding: 8px 12px;
  border-radius: 8px;
  font-size: 14px;
  color: #007aff;
  outline: none;
}

.panel-footer {
  display: flex;
  justify-content: flex-end;
  padding: 12px 4px 4px;
}

.apple-done-btn {
  background: none;
  border: none;
  color: #007aff;
  font-size: 17px;
  font-weight: 500;
  cursor: pointer;
}

/* Reminder Color Picker */
.reminder-color-picker {
  display: flex;
  gap: 8px;
  padding: 10px 38px;
  justify-content: flex-start;
  flex-wrap: wrap;
}

.color-dot {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  border: 2px solid transparent;
  cursor: pointer;
  transition: all 0.2s ease;
  padding: 0;
}

.color-dot:hover {
  transform: scale(1.15);
}

.color-dot.selected {
  border-color: rgba(0, 0, 0, 0.3);
  box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.8), 0 2px 8px rgba(0, 0, 0, 0.2);
}

/* Soft pastel colors */
.color-orange {
  background-color: #ffcc80;
}

.color-blue {
  background-color: #90caf9;
}

.color-green {
  background-color: #a5d6a7;
}

.color-red {
  background-color: #ef9a9a;
}

.color-yellow {
  background-color: #fff59d;
}

.color-purple {
  background-color: #ce93d8;
}

.color-pink {
  background-color: #f48fb1;
}

.color-gray {
  background-color: #b0bec5;
}

/* Reminder Error Text */
.panel-label-group {
  position: relative;
  display: flex;
  flex-direction: column;
}

.panel-error-text {
  font-size: 11px;
  color: #ff3b30;
  position: absolute;
  top: 18px;
  /* Below the "提醒" text */
  left: 0;
  white-space: nowrap;
}

.panel-actions {
  display: flex;
  align-items: center;
  gap: 12px;
}

.panel-preview-btn {
  background: rgba(0, 122, 255, 0.1);
  border: none;
  border-radius: 6px;
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #007aff;
  cursor: pointer;
  transition: all 0.2s ease;
  padding: 0;
}

.panel-preview-btn:hover {
  background: rgba(0, 122, 255, 0.2);
  transform: scale(1.05);
}

.panel-preview-btn:active {
  transform: scale(0.95);
}

/* Bell Ringing Animation */
.bell-ringing {
  animation: bell-swing 0.5s ease-in-out infinite;
  transform-origin: top center;
}

@keyframes bell-swing {

  0%,
  100% {
    transform: rotate(0deg);
  }

  20% {
    transform: rotate(15deg);
  }

  40% {
    transform: rotate(-10deg);
  }

  60% {
    transform: rotate(8deg);
  }

  80% {
    transform: rotate(-5deg);
  }
}

.bell-ringing .bell-clapper {
  animation: clapper-swing 0.5s ease-in-out infinite;
  transform-origin: top center;
}

@keyframes clapper-swing {

  0%,
  100% {
    transform: translateX(0);
  }

  25% {
    transform: translateX(2px);
  }

  75% {
    transform: translateX(-2px);
  }
}

/* Bell ripple effect */
.bell-ripple-container {
  position: relative;
  display: inline-block;
}

.bell-ripple {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 100%;
  height: 100%;
  border-radius: 50%;
  border: 2px solid rgba(0, 122, 255, 0.6);
  animation: bell-ripple-out 1s ease-out infinite;
  pointer-events: none;
}

.bell-ripple:nth-child(2) {
  animation-delay: 0.33s;
}

.bell-ripple:nth-child(3) {
  animation-delay: 0.66s;
}

@keyframes bell-ripple-out {
  0% {
    transform: translate(-50%, -50%) scale(1);
    opacity: 1;
  }

  100% {
    transform: translate(-50%, -50%) scale(2);
    opacity: 0;
  }
}


/* Dark Mode */
@media (prefers-color-scheme: dark) {
  .todo-details-panel.apple-style {
    background: rgba(45, 45, 45, 0.7);
    border-color: rgba(255, 255, 255, 0.1);
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
  }

  .panel-label {
    color: #fff;
  }

  .panel-divider {
    background-color: rgba(255, 255, 255, 0.1);
  }

  .panel-section.expanded {
    background: rgba(255, 255, 255, 0.05);
  }

  .apple-date-picker,
  .apple-time-picker {
    background: rgba(255, 255, 255, 0.1);
  }
}


.todo-checkbox-wrapper {
  position: relative;
  width: 22px !important;
  height: 16px !important;
  flex-shrink: 0;
  display: flex;
  align-items: flex-start;
  justify-content: flex-end !important;
  padding-top: 0 !important;
  /* Shift circle to top-right of the 22px red area */
  background-color: transparent !important;
  /* Visible Red Debug */
}

.todo-checkbox {
  appearance: none;
  width: 16px !important;
  height: 16px !important;
  border: 1.5px solid #c7c7cc;
  border-radius: 50%;
  transform: translateY(-2px) !important;
  /* Move circle HIGHER into Cyan area */
  /* Perfect circle */
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  outline: none;
  background: transparent;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
}

.todo-checkbox.draft {
  border-style: dashed;
  border-color: #c7c7cc;
}

.todo-checkbox:checked {
  background-color: #007aff;
  border-color: #007aff;
}

.todo-checkbox:checked::after {
  content: none;
}

@keyframes dotPop {
  to {
    transform: scale(1);
  }
}

.todo-input {
  flex: 1;
  border: none;
  background: transparent;
  font-size: 17px;
  color: var(--text-color);
  padding: 0;
  resize: none;
  outline: none;
  font-family: inherit;
  line-height: 1.4;
  /* Slightly more relaxed line height for better centering */
  display: block;
}

.todo-row.completed .todo-input {
  color: #8e8e93;
  transition: color 0.4s ease;
  /* line-through handled by animated pseudo-element */
}

/* Animated Strike-through */
/* Conflict removed to ensure single definition */

/* Only animate fade away if NOT in completed mode AND NOT a sub-item */
.todo-view:not(.completed-mode) .todo-row.completed:not(.sub-item) .todo-input-mirror-container {
  animation: fadeAway 0.5s ease-out forwards;
}

/* In completed mode, ensure it's visible and gray */
.todo-view.completed-mode .todo-row.completed .todo-input-mirror-container {
  animation: none;
  opacity: 1;
  color: #8e8e93;
}

@keyframes fadeAway {
  0% {
    opacity: 1;
    color: var(--text-color);
  }

  50% {
    opacity: 0.5;
    color: #8e8e93;
  }

  100% {
    opacity: 0;
    color: #8e8e93;
  }
}

/* Enhanced Blue Shimmer Sweep for Date Change */
.todo-meta-info.shimmer {
  position: relative;
  overflow: hidden;
  /* High-vibrancy blue sweep over gray text */
  background: linear-gradient(to right,
      #8e8e93 0%,
      #8e8e93 35%,
      #007aff 50%,
      #8e8e93 65%,
      #8e8e93 100%);
  background-size: 200% auto;
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  animation: blueSweep 1.0s cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes blueSweep {
  0% {
    background-position: 100% 0;
  }

  100% {
    background-position: -100% 0;
  }
}

/* Row Fade-in for new occurrences */
.todo-row {
  animation: fadeInRow 0.5s ease-out;
}

@keyframes fadeInRow {
  from {
    opacity: 0.5;
    transform: translateY(2px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.todo-empty {
  padding: 40px;
  text-align: center;
  color: #8e8e93;
  font-size: 15px;
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: text;
  height: 100%;
}

/* Transitions for switching modes */
.mode-container {
  flex: 1;
  display: flex !important;
  flex-direction: column !important;
  min-height: 0 !important;
}

/* animations for active states removed duplication */

/* Add animations for active states */
.note-mode-active .editor-container {
  animation: fadeInMode 0.3s ease-out;
}

.todo-mode-active .todo-view {
  animation: fadeInMode 0.3s ease-out;
}

/* Transitions for switching modes removed duplicate .todo-view rules */

/* 待办模式下仅隐藏编辑工具按钮，保留切换按钮和容器 */
.todo-mode-active .toolbar>*:not(.view-mode-btn),
.todo-mode-active .new-note-btn {
  display: none !important;
}

.todo-mode-active .toolbar .divider {
  display: none !important;
}

.todo-mode-active .toolbar,
body.inactive .todo-mode-active .toolbar {
  background: transparent !important;
  box-shadow: none !important;
  border: none !important;
}

/* FOCUS REMOVAL */
*:focus {
  outline: none !important;
  box-shadow: none !important
}

button:focus,
select:focus,
.dropdown:focus,
.toolbar-item:focus {
  outline: none !important;
  box-shadow: none !important
}

/* Dark Mode Overrides */
@media (prefers-color-scheme: dark) {

  /* Toolbar Button Hover: Dark Blue */
  .toolbar-item:hover:not([disabled]) {
    background-color: #154c79 !important;
    /* Deep Blue */
  }

  /* Dropdown Menus: Grey Background */
  .dropdown,
  .typeahead-popover {
    background-color: #2c2c2e !important;
    /* Dark Grey similar to macOS */
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5) !important;
    border: 1px solid #3a3a3c !important;
  }

  /* Dropdown Items */
  .dropdown .item,
  .typeahead-popover li {
    background-color: transparent !important;
    color: #dfdfdf !important;
  }

  /* Dropdown Item Hover */
  .dropdown .item:hover,
  .typeahead-popover li:hover {
    background-color: #3a3a3c !important;
    /* Lighter Grey */
  }

  /* Dropdown Divide */
  .dropdown .divider {
    background-color: #3a3a3c !important;
  }

  /* Invert icons in dropdowns if they are black images, but user said icons are white. 
     If icons are white, no filter needed. 
     Let's assume they are handled correctly elsewhere since user didn't complain about dropdown icon color, 
     just that menu background was white. */
}

/* Todo Reminder Styles */
.todo-row .reminder-btn {
  opacity: 0;
  cursor: pointer;
  margin-right: 8px;
  color: #8e8e93;
  transition: opacity 0.2s;
  display: flex;
  align-items: center;
  font-size: 14px;
  padding: 2px;
  border-radius: 4px;
}

.todo-row .reminder-btn:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.todo-row:hover .reminder-btn {
  opacity: 1;
}

.todo-row.has-reminder .reminder-btn {
  opacity: 1;
  color: #007aff;
}

/* Consolidated into primary todo-checkbox-wrapper definition at line 3052 */

/* Conflict removed to ensure single definition */

/* Conflict removed to ensure centering */

.todo-meta-info {
  display: flex !important;
  align-items: center;
  gap: 0;
  font-size: 11px;
  color: #8e8e93;
  margin-top: 2px !important;
  line-height: 1.2 !important;
  background-color: transparent !important;
  max-width: 100%;
  white-space: nowrap;
  overflow: hidden;
}

.meta-separator {
  color: #c7c7cc;
  font-size: 10px;
  flex-shrink: 0;
  user-select: none;
  padding: 0 8px;
  /* Consistent spacing around the bar */
}

.todo-meta-text {
  white-space: nowrap;
  flex-shrink: 0;
  /* Don't shrink individual segments */
}

.deadline-warning {
  color: #ff3b30;
  font-size: 11px;
  font-weight: 500;
  flex-shrink: 0;
}

.todo-progress-indicator {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-size: 11px;
  color: #007aff;
  vertical-align: middle;
  flex-shrink: 0;
}

.todo-meta-info.overdue {
  color: #ff3b30;
}

/* Reminder Dialog */
.reminder-dialog-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.2);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
  backdrop-filter: blur(2px);
  -webkit-backdrop-filter: blur(2px);
}

.reminder-dialog {
  background: #fff;
  width: 320px;
  border-radius: 12px;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 16px;
  font-size: 13px;
  animation: dialog-pop 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes dialog-pop {
  from {
    transform: scale(0.9);
    opacity: 0;
  }

  to {
    transform: scale(1);
    opacity: 1;
  }
}

/* Dark Mode support for dialog */
@media (prefers-color-scheme: dark) {
  .reminder-dialog {
    background: #1e1e1e;
    color: white;
    border: 1px solid #333;
  }
}

.reminder-dialog-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.reminder-dialog-header h3 {
  margin: 0;
  font-size: 16px;
  font-weight: 600;
}

.close-btn {
  background: none;
  border: none;
  font-size: 20px;
  cursor: pointer;
  color: #8e8e93;
  padding: 0;
  line-height: 1;
}

.form-group label {
  display: block;
  margin-bottom: 8px;
  font-weight: 500;
  color: #8e8e93;
}

.datetime-inputs {
  display: flex;
  gap: 10px;
}

.reminder-dialog input,
.reminder-dialog select {
  width: 100%;
  padding: 8px;
  border-radius: 8px;
  border: 1px solid #e5e5ea;
  background: #f2f2f7;
  color: inherit;
  font-family: inherit;
  font-size: 13px;
  outline: none;
  box-sizing: border-box;
}

.datetime-inputs input {
  width: 50%;
}

@media (prefers-color-scheme: dark) {

  .reminder-dialog input,
  .reminder-dialog select {
    background: #2c2c2e;
    border-color: #3a3a3c;
  }
}

.datetime-preview {
  margin-top: 6px;
  font-size: 12px;
  color: #007aff;
  height: 14px;
  font-weight: 500;
}

.reminder-dialog-footer {
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 10px;
}

.reminder-dialog-footer button {
  padding: 8px 16px;
  border-radius: 8px;
  border: none;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
}

.btn-cancel {
  background: #f2f2f7;
  color: #000;
}

.btn-save {
  background: #007aff;
  color: white;
}

@media (prefers-color-scheme: dark) {
  .btn-cancel {
    background: #3a3a3c;
    color: white;
  }
}

/* Radio Group */
.radio-group {
  display: flex;
  gap: 15px;
}

.radio-option {
  display: flex;
  align-items: center;
  gap: 6px;
}

.radio-option.disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Updated Reminder Dialog Styles */

/* Bold and larger labels */
.dialog-label {
  font-size: 16px;
  font-weight: 700;
  color: #333;
  margin-bottom: 10px;
}

@media (prefers-color-scheme: dark) {
  .dialog-label {
    color: #fff;
  }
}

/* Input layout - Date long, Time short */
.datetime-inputs {
  display: flex;
  gap: 12px;
}

.date-input {
  flex: 2;
  /* Takes up more space */
  height: 38px;
}

.time-input {
  flex: 1;
  /* Takes up less space */
  height: 38px;
}

/* Make select match input height */
.reminder-dialog select {
  height: 38px;
  padding: 0 8px;
  /* Reset padding to match */
}

/* Remove Button */
.btn-remove {
  background-color: #ffe5e5;
  color: #ff3b30;
  border: none;
  border-radius: 8px;
  padding: 8px 12px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  margin-right: auto;
  /* Push to left */
}

.btn-remove:hover {
  background-color: #ffd1d1;
}

@media (prefers-color-scheme: dark) {
  .btn-remove {
    background-color: rgba(255, 69, 58, 0.2);
    color: #ff453a;
  }

  .btn-remove:hover {
    background-color: rgba(255, 69, 58, 0.3);
  }
}

/* Adjust footer to align items */
.reminder-dialog-footer {
  display: flex;
  justify-content: flex-end;
  /* Default right align */
  gap: 10px;
  margin-top: 20px;
  align-items: center;
}


/* Updated Reminder Dialog Styles - Part 2 */

.form-group {
  margin-bottom: 24px;
  /* Increased spacing between sections */
}

/* Flex header for label and preview */
.form-header {
  display: flex;
  align-items: center;
  /* Align vertically */
  gap: 8px;
  /* Spacing between label and preview */
  margin-bottom: 10px;
}

/* Reset margin on label since header handles spacing */
.form-header .dialog-label {
  margin-bottom: 0;
}

/* Style the preview text */
.datetime-preview {
  font-size: 13px;
  color: #007aff;
  font-weight: 500;
}


/* Updated Reminder Dialog Styles - Part 3 */

/* Force labels to be pure black per request */
.dialog-label {
  color: #000 !important;
}

/* Ensure header alignment using baseline */
.form-header {
  display: flex;
  align-items: baseline;
  /* Align text baselines */
  line-height: 1;
}

/* Remove previous height hacks to let baseline work */
.form-header .dialog-label {
  /* Resetting previous specific styles if any */
  height: auto;
  line-height: normal;
}

/* Spacing and visual alignment */
.datetime-preview {
  margin-left: 12px;
  font-size: 13px;
  color: #007aff;
  font-weight: 500;
  /* Optional: nudge if font metrics are wild, but baseline usually works */
}


/* Todo UI Refinements */

/* 1. Round Checkbox */
.todo-checkbox {
  border-radius: 50% !important;
  width: 16px !important;
  height: 16px !important;
  min-width: 16px;
  appearance: none;
  -webkit-appearance: none;
  border: 1px solid #ccc;
  background-color: transparent;
  cursor: pointer;
  margin-right: 8px;
  flex-shrink: 0;
  position: relative;
}

.todo-checkbox:checked {
  background-color: #007aff;
  border-color: #007aff;
}

.todo-checkbox:checked::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 10px;
  height: 8px;
  /* Basic checkmark using SVG or clip path if needed, but CSS shapes are tricky without assets. 
       Let's use a simple unicode or just colors for now, usually browser default is okay but we reset 'appearance: none'. 
       So we need a checkmark. */
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='1 7 4 10 12 1'%3E%3C/polyline%3E%3C/svg%3E");
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
}

/* 2. Alignment */
/* Ensure the delete button is vertically centered in the row, regardless of text height */
/* Consolidated into primary todo-row definition at line 2388 */

/* But we said previously we used flex-start for multi-line. 
   If text is multi-line, checkbox and icons are weird.
   User wants icons centered for single line, maybe top-aligned for multi? 
   No, user specifically asked 'delete icon is whole row center aligned'. 
   So we MUST use align-items: center. 
*/



.todo-input {
  margin-top: 0 !important;
  margin-bottom: 0 !important;
  padding-top: 0 !important;
  padding-bottom: 0 !important;
  min-height: 0 !important;
  height: auto !important;
  /* Adjust padding to align text with icons */

}

/* 3. Hover Effects */
.todo-delete-btn {
  /* Ensure existing styles are correct */
  display: flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  border-radius: 4px;
  cursor: pointer;
  color: #8e8e93;
  opacity: 0;
  /* Hidden by default per design */
  transition: opacity 0.2s, background-color 0.2s, color 0.2s;
  margin-left: 4px;
}

.todo-row:hover .todo-delete-btn {
  opacity: 1;
}

.todo-delete-btn:hover {
  background-color: rgba(255, 59, 48, 0.1);
  /* Pale Red */
  color: #ff3b30;
  /* Red */
}

/* Bell / Reminder Button */
.reminder-btn {
  display: flex;
  /* Ensure centering */
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  border-radius: 4px;
  /* Slightly squircle */
  transition: opacity 0.2s, background-color 0.2s, color 0.2s;
}

.reminder-btn:hover {
  background-color: rgba(0, 122, 255, 0.1) !important;
  /* Pale Blue */
  color: #007aff !important;
  /* Blue */
}

/* 4. Animation fix */
/* We will handle animation logic via class names in next step if needed, or override here. */
/* The current animation is inline style in React. We need to go into TodoView.tsx to change the transition type. */


/* Todo Icon Refinements */

/* Ensure delete button size explicitly matches */
.todo-delete-btn {
  width: 24px !important;
  height: 24px !important;
  margin-left: 2px !important;
  /* Reduce spacing */
  padding: 0 !important;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Ensure reminder button size explicitly matches */
.reminder-btn {
  width: 24px !important;
  height: 24px !important;
  margin-left: 0 !important;
  padding: 0 !important;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Container for icons to control spacing tightly */
.todo-row .icon-group {
  display: flex;
  align-items: center;
  gap: 0px;
  /* Tighter gap */
}

/* Visual fix for exact hover box matching */
.todo-delete-btn:hover,
.reminder-btn:hover {
  border-radius: 4px;
}


/* Todo Icon Refinements - Final */

/* Icon Group Container */
.todo-icon-group {
  display: flex;
  align-items: flex-start !important;
  gap: 4px;
  padding-top: 0 !important;
  /* Propping padding-top removed - align with first line accurately */
  margin-left: auto !important;
  /* Anchor icons to the right side */
  min-height: 0 !important;
  height: auto !important;
}

/* Ensure delete button size is larger per request */
.todo-delete-btn {
  width: 28px !important;
  height: 28px !important;
  font-size: 20px !important;
  /* Substantial 'x' to match bell icon */
  font-weight: 300 !important;
  margin: 0 !important;
  padding: 0 !important;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Ensure reminder button size explicitly matches */
.reminder-btn {
  width: 32px !important;
  height: 32px !important;
  margin: 0 !important;
}

/* Hover background radius */
.todo-delete-btn:hover,
.reminder-btn:hover {
  border-radius: 6px;
  /* Slightly larger radius for larger box */
}

/* Todo Context Menu */
.todo-context-menu {
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: saturate(180%) blur(20px);
  -webkit-backdrop-filter: saturate(180%) blur(20px);
  border-radius: 8px;
  box-shadow: 0 4px 24px rgba(0, 0, 0, 0.15), 0 0 0 0.5px rgba(0, 0, 0, 0.1);
  padding: 4px;
  min-width: 140px;
  overflow: hidden;
}

.context-menu-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 12px;
  cursor: pointer;
  border-radius: 4px;
  font-size: 13px;
  color: #1a1a1a;
  transition: background-color 0.1s ease;
}

.context-menu-item:hover {
  background-color: rgba(0, 122, 255, 0.1);
}

.context-menu-item svg {
  flex-shrink: 0;
  opacity: 0.7;
}

.context-menu-item span {
  flex: 1;
}

/* Dark mode context menu */
@media (prefers-color-scheme: dark) {
  .todo-context-menu {
    background: rgba(45, 45, 45, 0.95);
    box-shadow: 0 4px 24px rgba(0, 0, 0, 0.4), 0 0 0 0.5px rgba(255, 255, 255, 0.1);
  }

  .context-menu-item {
    color: #eee;
  }

  .context-menu-item:hover {
    background-color: rgba(255, 255, 255, 0.1);
  }

  .context-menu-item svg {
    stroke: #eee;
  }
}

/* Layout & Responsiveness Refinements */

/* 1. Icon Position */
.todo-icon-group {
  margin-right: 8px !important;
  /* Move icons away from right edge */
}

/* Conflict removed to ensure single definition */

/* 3. Input Textarea */
.todo-input {
  resize: none;
  /* User cannot drag resize */
  overflow: hidden;
  /* Hide scrollbar completely */
  min-height: 0 !important;
  height: auto;
  /* Allow auto-growth script to work */
  width: 100%;
  box-sizing: border-box;
  /* Ensure wrapping */
  white-space: pre-wrap;
  word-break: break-word;
}

/* Hide scrollbar explicitly for WebKit */
.todo-input::-webkit-scrollbar {
  display: none;
}

/* 4. Meta Info Truncation - obsolete, handled above */


/* --- Mirror Auto-grow Technique --- */

/* --- Mirror Auto-grow Technique (Robust Flow Version) --- */

.todo-input-mirror-container {
  display: block !important;
  width: 100% !important;
  position: relative !important;
  min-height: 20px;
  /* Minimum line height */
}

/* Share identical styles to ensure identical wrapping and font layout */
.todo-input,
.todo-input-mirror {
  width: 100% !important;
  margin: 0 !important;
  padding: 0 !important;
  font-family: inherit;
  font-size: 16px;
  line-height: 1.2 !important;
  vertical-align: top;
  box-sizing: border-box;
  white-space: pre-wrap !important;
  word-break: break-word !important;
  overflow-wrap: break-word !important;
  min-height: 0 !important;
}

.todo-input-mirror {
  display: block !important;
  height: auto !important;
  visibility: hidden;
  /* Default to hidden, overridden by React inline style */
  pointer-events: none !important;
}

.todo-input {
  display: block !important;
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  width: 100% !important;
  height: 100% !important;
  /* Fill container from mirror growth */
  resize: none !important;
  overflow: hidden !important;
  color: inherit;
  background: transparent !important;
  border: none !important;
  outline: none !important;
}

/* --- Completed Mode Gray Styles --- */
.todo-view.completed-mode .todo-input {
  color: #999 !important;
}

.todo-view.completed-mode .todo-meta-info {
  color: #ccc !important;
}

.todo-view.completed-mode .todo-checkbox {
  opacity: 0.5;
}

.todo-content-wrapper {
  overflow: visible !important;
  display: block !important;
  margin-top: 0 !important;
  margin-bottom: 0 !important;
  padding-bottom: 0 !important;
  flex: 1;
  min-width: 0 !important;
  /* Crucial for flex-shrink and forced wrap */
  height: auto !important;
}

/* --- Context Menu --- */
.todo-context-menu-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 9998;
  background: transparent;
}

.todo-context-menu {
  position: fixed;
  z-index: 9999;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(0, 0, 0, 0.1);
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  padding: 4px;
  min-width: 180px;
  display: flex;
  flex-direction: column;
}

@media (prefers-color-scheme: dark) {
  .todo-context-menu {
    background: rgba(40, 40, 40, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.1);
  }
}

.todo-context-menu .menu-item {
  padding: 6px 12px;
  font-size: 13px;
  color: var(--text-color, #1a1a1a);
  cursor: pointer;
  border-radius: 4px;
  transition: background 0.1s;
}

.todo-context-menu .menu-item:hover {
  background: rgba(0, 122, 255, 0.1);
  color: #007aff;
}

.todo-context-menu .menu-item.delete:hover {
  background: rgba(255, 59, 48, 0.1);
  color: #ff3b30;
}

.todo-context-menu .menu-item.disabled {
  color: #999;
  pointer-events: none;
  background: transparent;
}

.todo-context-menu .menu-divider {
  height: 1px;
  background: rgba(0, 0, 0, 0.1);
  margin: 4px 0;
}

@media (prefers-color-scheme: dark) {
  .todo-context-menu .menu-divider {
    background: rgba(255, 255, 255, 0.1);
  }

  .todo-context-menu .menu-item.disabled {
    color: #555;
  }
}

/* --- Sub-tasks Styles --- */

.todo-row.sub-item {
  padding-left: 36px !important;
  border-bottom: 0.5px solid rgba(200, 200, 200, 0.3) !important;
}

.todo-row.sub-item.completed .todo-input {
  color: #8e8e93 !important;
  text-decoration: none !important;
  opacity: 1 !important;
  /* Force visible */
}

@media (prefers-color-scheme: dark) {
  .todo-row.sub-item {
    border-bottom: 0.5px solid rgba(100, 100, 100, 0.3) !important;
  }
}

.todo-row.sub-item .todo-checkbox {
  width: 14px !important;
  height: 14px !important;
  min-width: 14px !important;
}

.todo-row.sub-item .todo-input,
.todo-row.sub-item .todo-input-mirror {
  font-size: 15px !important;
}

.todo-checkbox.sub-item-disabled {
  opacity: 0.5;
  cursor: not-allowed !important;
}

.todo-checkbox.sub-item-disabled:checked {
  background-color: #c7c7cc !important;
  border-color: #c7c7cc !important;
  filter: grayscale(1);
}

/* --- Progress Indicator --- */
.todo-progress-indicator {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-size: 11px;
  color: #007aff;
  vertical-align: middle;
  flex-shrink: 0;
}

.todo-progress-bar {
  width: 60px;
  height: 4px;
  background: rgba(0, 122, 255, 0.15);
  border-radius: 2px;
  overflow: hidden;
  position: relative;
}

.todo-progress-bar-fill {
  height: 100%;
  background: #007aff;
  border-radius: 2px;
  transition: width 0.3s ease;
}

/* --- Deadline Warning --- */
.deadline-warning {
  color: #ff3b30;
  font-size: 11px;
  font-weight: 500;
}

.datetime-quick-pills {
  display: flex;
  gap: 6px;
  margin-right: auto;
  align-items: center;
}

.datetime-pill {
  padding: 4px 10px;
  background-color: var(--secondary-bg, rgba(60, 60, 67, 0.05));
  border-radius: 12px;
  font-size: 11px;
  color: var(--text-secondary, #666);
  cursor: pointer;
  border: 1px solid transparent;
  transition: all 0.2s ease;
  white-space: nowrap;
}

.datetime-pill:hover {
  background-color: var(--hover-bg, rgba(60, 60, 67, 0.1));
  color: var(--accent-color, #1877f2);
}

.datetime-pill:active {
  transform: scale(0.95);
}

/* --- Hover Delay UI --- */

/* Ensure wrapper is positioned for absolute child */
.todo-content-wrapper {
  position: relative;
  /* Ensure z-index is managed if needed, but default auto is fine */
}

/* Dimming Effect */
/* Apply to all children EXCEPT the hover card */
.todo-content-wrapper.dimmed>*:not(.todo-hover-card) {
  opacity: 0.3;
  filter: grayscale(100%);
  transition: opacity 0.2s ease, filter 0.2s ease;
}

/* Hover Card Container */
.todo-hover-card {
  position: absolute;
  top: 50%;
  /* Center vertically relative to content wrapper (which is usually row height) */
  left: 0;
  transform: translateY(-50%);
  z-index: 100;
  display: flex;
  align-items: center;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: saturate(180%) blur(20px);
  -webkit-backdrop-filter: saturate(180%) blur(20px);
  border-radius: 12px;
  padding: 6px 10px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15), 0 0 0 0.5px rgba(0, 0, 0, 0.05);
  gap: 8px;
  white-space: nowrap;
  animation: cardFadeIn 0.2s ease-out;
  pointer-events: auto;
  /* Ensure clicks work */
}

@keyframes cardFadeIn {
  from {
    opacity: 0;
    transform: translateY(-40%);
  }

  to {
    opacity: 1;
    transform: translateY(-50%);
  }
}

/* Label "延时" */
.hover-card-label {
  font-size: 13px;
  font-weight: 600;
  color: #1a1a1a;
  margin-right: 4px;
}

/* Action Buttons Group */
.hover-card-actions {
  display: flex;
  gap: 6px;
}

/* Individual Delay Button */
.hover-delay-btn {
  appearance: none;
  -webkit-appearance: none;
  border: 1px solid rgba(0, 0, 0, 0.05);
  background: rgba(0, 0, 0, 0.05);
  border-radius: 6px;
  padding: 4px 10px;
  font-size: 12px;
  font-weight: 500;
  color: #333;
  cursor: pointer;
  transition: all 0.15s ease;
  line-height: normal;
}

.hover-delay-btn:hover {
  background: #007aff;
  color: white;
  border-color: #007aff;
  box-shadow: 0 2px 4px rgba(0, 122, 255, 0.2);
}

.hover-delay-btn:active {
  transform: scale(0.96);
}

/* Close 'x' Button */
.hover-card-close {
  margin-left: 6px;
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  cursor: pointer;
  color: #8e8e93;
  transition: all 0.15s ease;
}

.hover-card-close:hover {
  background: rgba(0, 0, 0, 0.05);
  color: #333;
}

/* Dark Mode Overrides */
@media (prefers-color-scheme: dark) {
  .todo-hover-card {
    background: rgba(45, 45, 45, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4);
  }

  .hover-card-label {
    color: #fff;
  }

  .hover-delay-btn {
    background: rgba(255, 255, 255, 0.1);
    border-color: transparent;
    color: #eee;
  }

  .hover-delay-btn:hover {
    background: #0a84ff;
    color: white;
  }

  .hover-card-close {
    color: #999;
  }

  .hover-card-close:hover {
    background: rgba(255, 255, 255, 0.1);
    color: #fff;
  }
}